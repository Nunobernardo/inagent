(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],t):n.FileDropzone=t(n.jQuery)})(this,function(n){"use strict";function f(n){var u=this,i=[],f=[],e,o;(n.forEach(function(n){t.fileTypeValid(n,u.options.accept)?(!u.options.unique||u.getFiles().indexOf(n)<0)&&i.push(n):f.push(n)}),f.length&&this.options.onInvalid&&this.options.onInvalid.bind(this)(f),i[0])&&(this.multiple||(i=i.slice(0,1)),e=!0,this.options.beforeAdd&&(o=this.options.beforeAdd.bind(this)(i),typeof o=="boolean"&&(e=o)),e)&&(!this.multiple||this.options.forceReplace?r.bind(this)(i):r.bind(this)(this.getFiles().concat(i)),this.options.onChange&&this.options.onChange.bind(this)())}function a(){window.__dropzone_styled_inserted||(n("<style>\n      .dropzone--clickable { cursor: pointer; }\n      .dropzone--file-hover { box-shadow: inset 0 0 10px #aaa; }\n    <\/style>").appendTo("head"),window.__dropzone_styled_inserted=!0)}function v(n){(u++,!this.disabled&&t.eventHasFile(n))&&(n.preventDefault(),n.stopPropagation(),u==1&&(this.options.onEnter&&this.options.onEnter.bind(this)(n),this.element.addClass(this.options.fileHoverClass)))}function o(n){(u--,!this.disabled&&t.eventHasFile(n))&&(n.preventDefault(),n.stopPropagation(),u===0&&(this.options.onLeave&&this.options.onLeave.bind(this)(n),this.element.removeClass(this.options.fileHoverClass)))}function y(n){!this.disabled&&t.eventHasFile(n)&&(n.preventDefault(),this.options.onHover&&this.options.onHover.bind(this)(n))}function p(n){if(u--,!this.disabled&&t.eventHasFile(n)){n.preventDefault();n.stopPropagation();this.options.onDrop&&this.options.onDrop.bind(this)(n);this.element.removeClass(this.options.fileHoverClass);var i=b.bind(this)(t.getFilesFromEvent(n));f.bind(this)(i)}}function w(){this.disabled||this.clickable&&this.openFileChooser()}function b(n){for(var t,i=[],u=[],r=0,f=n.length;r<f;r++)t=n[r],t.type||t.size%4096!=0?u.push(t):i.push(t);return i.length>0&&this.options.onFolderFound&&this.options.onFolderFound.bind(this)(i),this.options.noFolder?u:n}n=n&&"default"in n?n["default"]:n;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),t={isString:function(n){return typeof n=="string"||n instanceof String},isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},isObject:function(n){return n&&(typeof n=="undefined"?"undefined":s(n))==="object"&&!this.isArray(n)},addUnique:function(n,t){return n.indexOf(t)<0&&n.push(t),n},remove:function(n,t){var i=n.indexOf(t);return i>=0&&n.splice(i,1),n},assign:function(n,t){if(!n||!t)return n;for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},without:function(n,t){var r,i,f,u;for(u=[],i=0,f=n.length;i<f;i++)r=n[i],r!==t&&u.push(r);return u},fileTypeValid:function(n,t){var i,s,f,r,h,c;if(!t)return!0;var l=t.replace(/\/.*$/,""),a=t.split(","),u=!0,e=!1,o=undefined;try{for(i=a[Symbol.iterator]();!(u=(s=i.next()).done);u=!0)if(f=s.value,r=f.trim(),/^\./.test(r)){if(h=n.name.toLowerCase(),h.split(".").pop()===r.replace(".","").toLowerCase())return!0}else if(/\/\*$/.test(r)){if(c=n.type.replace(/\/.*$/,""),c===l)return!0}else if(n.type===f)return!0}catch(v){e=!0;o=v}finally{try{!u&&i.return&&i.return()}finally{if(e)throw o;}}return!1},eventHasFile:function(n){var i=n.dataTransfer||n.originalEvent.dataTransfer,t,r;if(i.types)for(t=0,r=i.types.length;t<r;t++)if(i.types[t]=="Files")return!0;return!1},getFilesFromEvent:function(n){var t=n.dataTransfer||n.originalEvent.dataTransfer,r=[],i,f,u;if(t.items&&t.items.length)for(i=0,f=t.items.length;i<f;i++)u=t.items[i],u.kind==="file"&&r.push(u.getAsFile());else r=t.files;return r}},i=function(){},e=[],r=function(n){e=n},u=0,l={target:"",fileHoverClass:"dropzone--file-hover",clickable:!0,multiple:!0,paramName:"file",accept:"",capture:!1,unique:!1,noFolder:!0,forceReplace:!1,onChange:i,onEnter:i,onLeave:i,onHover:i,onDrop:i,onFolderFound:i,onInvalid:i,beforeAdd:i};return function(){function i(r,u){h(this,i);var e=u||{},f=n(r);if(t.isString(r)||!t.isObject(r)||r instanceof n||r instanceof Element||(e=r||{},f=n(e.target)),!f||f.length<=0)throw new Error("No matched element.");this.element=f;this.options=Object.assign(JSON.parse(JSON.stringify(l)),e);this.disabled=!1;this.fileInput=null;this.multiple=!1;this.init()}return c(i,[{key:"init",value:function(){r.bind(this)([]);this.clickable=this.options.clickable;this.clickable&&this.enableClick();this.element[0].addEventListener("click",w.bind(this));this.multiple=typeof this.options.multiple=="boolean"?this.options.multiple:!0;this.fileInput=n('<input type="file" hidden name="'+this.options.paramName+'" class="'+this.options.paramName+'" >');this.element.next(this.fileInput);this.multiple&&this.fileInput.attr("multiple","multiple");this.options.capture&&this.fileInput.attr("capture",this.options.capture);this.options.accept&&this.fileInput.attr("accept",this.options.accept);this.element.on("dragenter",v.bind(this)).on("dragleave",o.bind(this)).on("dragend",o.bind(this)).on("dragover",y.bind(this)).on("drop",p.bind(this));var t=this;this.fileInput.on("click",function(n){n.stopPropagation()}).on("change",function(i){var u,e,r,s,o;if(!t.disabled){for(u=i.target.files,e=[],r=0,s=u.length;r<s;r++)o=u[r],o instanceof File&&e.push(o);f.bind(t)(e);t.options.unique||n(this).val("")}});a()}},{key:"addFiles",value:function(n){f.bind(this)(n)}},{key:"getFiles",value:function(){return e}},{key:"removeFile",value:function(n){var u=this.getFiles(),e=u.length,i,f;return n instanceof File?(i=n,f=t.without(u,i),r.bind(this)(f)):typeof n=="number"&&(i=u.splice(n,1)[0]),this.getFiles().length===e-1?(this.options.onChange&&this.options.onChange.bind(this)(),i):null}},{key:"pop",value:function(){var n=this.getFiles(),t;return n.length?(t=n.pop(),r.bind(this)(n),this.options.onChange&&this.options.onChange.bind(this)(),t):null}},{key:"shift",value:function(){var n=this.getFiles(),t;return n.length?(t=n.shift(),r.bind(this)(n),this.options.onChange&&this.options.onChange.bind(this)(),t):null}},{key:"openFileChooser",value:function(){this.fileInput.click()}},{key:"clearAll",value:function(){r.bind(this)([]);this.options.onChange&&this.options.onChange.bind(this)()}},{key:"disable",value:function(){this.disabled=!0;this.element.addClass("dropzone--disabled");this.fileInput.prop("disabled",!0)}},{key:"enable",value:function(){this.disabled=!1;this.element.removeClass("dropzone--disabled");this.fileInput.prop("disabled",!1)}},{key:"disableClick",value:function(){this.element.removeClass("dropzone-area dropzone--clickable");this.clickable=!1}},{key:"enableClick",value:function(){this.element.addClass("dropzone-area dropzone--clickable");this.clickable=!0}}],[{key:"getFileSize",value:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"b",i;if(!(n instanceof File))throw new TypeError('First argument "file" should be a File instance.');if(t&&typeof t=="string"||(t="b"),t=="b")return n.size;if(i=["b","kb","mb","gb","tb"].indexOf(t.toLowerCase()),i<0)throw new TypeError('The unit should be one of "tb", "gb", "mb", "kb" and "b", the default value is "b"');return n.size/Math.pow(1024,i)}}]),i}()});